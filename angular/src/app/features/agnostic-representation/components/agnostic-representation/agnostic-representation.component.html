<div class="container-fluid">
  <nav class="row">
    <div class="col-7">
      <ng-container *ngIf="selectedRegion$ | async">
        <app-crud-toolbar (onClear)="clear()" (modeChange)="onModeChange($event)" (onDelete)="deleteSelectedSymbol()" [(mode)]="mode" (onZoomFit)="zoomFit()" (onZoomIn)="zoomIn()" (onZoomOut)="zoomOut()">
        </app-crud-toolbar>
      </ng-container>
    </div>
    <div class="col-2">
      <ng-container *ngIf="selectedRegion$ | async">
        <button type="button" class="btn btn-primary" title="End to end"  (click)="classifyEnd2End()">
          {{endToEndButtonLabel}}
        </button>
      </ng-container>
    </div>
    <div class="col-3" id="linksPhases">
      Go to:
      <button (click)="openDocumentAnalysis()">Doc. analysis</button>
      <button (click)="openSemanticRepresentation()" disabled>Semantic</button>
    </div>
  </nav>

  <aside id="addMode" class="row" [hidden]="!isEditingMode() && !isAddingMode()">
    <div class="col-12">
      <div class="btn-group btn-group-toggle" ngbRadioGroup
           name="addMethodRadioButtonGroup" [(ngModel)]="addMethodType">
        <label ngbButtonLabel>
          <input ngbButton type="radio" name="addMethodRadioButton" [value]="'boundingbox'"> Bounding box
        </label>
        <label ngbButtonLabel>
          <input ngbButton type="radio" name="addMethodRadioButton" [value]="'strokes'"> Strokes
        </label>
      </div>
    </div>
  </aside>

  <div class="row">
    <div class="col-12">
      <div *ngIf="selectedRegion$ | async as selectedRegion; else noRegionSelected">
        <section class="row">
          <div class="col">
            <app-image [imageID]="imageID" [shapes]="selectedRegionShapes"
                       [zoomFactor]="selectedRegionZoomFactor"
                       [crop]="selectedRegion.boundingBox"
                       (svgShapeCreated)="onSymbolCreated($event)"
                       (svgShapeChanged)="onSymbolShapeChanged($event)"
                       [nextShapeToDraw]="nextShapeToDraw"
                       [(mode)]="mode"
                       [(selectedShapeID)]="selectedShapeID"
            ></app-image>
          </div>
        </section>
        <section class="row" *ngIf="selectedSymbol">
          <div class="offset-1 col-3">
            <p>Selected symbol ID: <strong>{{selectedSymbol?.id}}</strong></p>
          </div>
          <div class="col-4">
            <p>Agnostic symbol type: <strong>{{selectedSymbol?.agnosticSymbolType}}</strong></p>
          </div>
          <div class="col-4">
            <p>Position in staff: <strong>{{selectedSymbol?.positionInStaff}}</strong></p>
          </div>
        </section>
        <section class="row">
          <div class="col">
            <app-agnostic-staff
                                [regionCropped]="selectedRegion.boundingBox"
                                [(mode)]="mode" [svgAgnosticSymbolSet]="svgSet$ | async"
            >
            </app-agnostic-staff>
          </div>
        </section>
      </div>
      <ng-template #noRegionSelected>
        <div class="jumbotron align-content-md-center" id="jumbotronSelectRegion">
          <p>Select a region</p>
        </div>
      </ng-template>
    </div>
  </div>

  <section class="row d-flex justify-content-center" *ngIf="classifiedSymbols">
    <div class="col-2">
      <p>Select a symbol type:</p>
    </div>
    <div class="col-10">
      <app-agnostic-toolbar [mode]="mode"
                            [svgAgnosticSymbolSet]="svgSet$ | async"
                            (agnosticSymbolSelected)="onAgnosticSymbolTypeSelected($event)"
                            [selectedAgnosticSymbolType]="selectedAgnosticSymbolType"
                            [filter]="classifiedSymbols"
      >
      </app-agnostic-toolbar>
    </div>
  </section>

  <section class="row">
    <div class="col-1">
      <ng-container *ngIf="selectedSymbol">
        <button type="button" class="btn btn-primary" title="Move pitch up" (click)="movePitchUpSelectedSymbol()">
          <fa-icon icon="angle-up"  size="2x"></fa-icon>
        </button>
        <p>Move pitch</p>
        <button type="button" class="btn btn-primary" title="Move pitch down"  (click)="movePitchDownSelectedSymbol()">
          <fa-icon icon="angle-down" size="2x"></fa-icon>
        </button>
      </ng-container>
    </div>
    <div class="col-7">
      <app-agnostic-toolbar *ngIf="selectedSymbol"
                            [mode]="mode" [classifier]="classifier" (classifierChanged)="onClassifierChanged($event)"
                            [svgAgnosticSymbolSet]="svgSet$ | async"
                            (agnosticSymbolSelected)="onAgnosticSymbolTypeSelected($event)"
                            (pitchDown)="movePitchDownSelectedSymbol()"
                            (pitchUp)="movePitchUpSelectedSymbol()">
      </app-agnostic-toolbar>
      <!-- [agnosticSymbolToolbarCategories]="agnosticSymbolToolbarCategories"-->
    </div>

    <div [ngClass]="imagePreviewClass">
      <div id="imagePreviewIcons">
        <button (click)="toggleImagePreview()">
          <fa-icon *ngIf="isImagePreviewMinimized" icon="expand-arrows-alt" class="icons"></fa-icon>
          <fa-icon *ngIf="!isImagePreviewMinimized" icon="compress-arrows-alt" class="icons"></fa-icon>
        </button>
        <span>Region selection</span>
      </div>
      <app-image [imageID]="imageID" [shapes]="imagePreviewShapes" [zoomFactor]="imagePreviewZoomFactor"
                 [(selectedShapeID)]="selectedRegionShapeID"
                 [mode]="'eSelecting'">
      </app-image>
    </div>

  </section>

</div>
